<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Leaf Disease Detector</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: "Inter", sans-serif;
            /* Enhanced gradient background for the body */
            background: linear-gradient(to bottom right, #dcfce7, #a7f3d0); /* Light green to slightly darker green */
            min-height: 100vh; /* Ensure gradient covers full viewport height */
        }
        canvas {
            border: 2px dashed #34d399; /* More vibrant green dashed border */
            border-radius: 0.75rem; /* Rounded corners */
            background-color: #ecfdf5; /* Even lighter green inside */
            max-width: 100%; /* Ensure canvas is responsive */
            height: auto; /* Maintain aspect ratio */
            display: block; /* Remove extra space below canvas */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Subtle shadow for depth */
        }
        /* Custom styles for the file input to make it look better */
        input[type="file"] {
            display: none; /* Hide the default input */
        }
        .custom-file-upload {
            /* Gradient background for the upload button */
            background: linear-gradient(to right, #10b981, #059669); /* Emerald to darker emerald */
            display: inline-block;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-radius: 0.75rem;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Shadow for button */
            border: none; /* Remove default border */
        }
        .custom-file-upload:hover {
            background: linear-gradient(to right, #059669, #047857); /* Darker gradient on hover */
            transform: translateY(-2px); /* Slight lift effect */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4 text-gray-800">
    <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl
                /* Subtle gradient for the main container */
                bg-gradient-to-br from-white to-emerald-50">
        <h1 class="text-3xl font-bold text-center text-emerald-700 mb-6">ðŸŒ¿ Plant Leaf Disease Detector</h1>

        <!-- File Upload Section -->
        <div class="mb-6 text-center">
            <label for="imageUpload" class="custom-file-upload">
                Upload Leaf Image
            </label>
            <input type="file" id="imageUpload" accept="image/*" class="hidden">
            <p class="text-sm text-gray-500 mt-2">Upload an image of a plant leaf (JPG, PNG, GIF).</p>
        </div>

        <!-- Canvas for Image Display -->
        <div class="mb-6 flex justify-center">
            <canvas id="leafCanvas" class="w-full h-96"></canvas>
        </div>

        <!-- Detection Button -->
        <div class="mb-6 text-center">
            <button id="detectButton" class="
                bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3 px-6 rounded-xl shadow-md
                transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-opacity-75
                /* Gradient for the detect button */
                bg-gradient-to-r from-emerald-600 to-emerald-800 hover:from-emerald-700 hover:to-emerald-900
                border-none">
                Detect Disease
            </button>
        </div>

        <!-- Result Display Area -->
        <div class="p-4 rounded-lg border border-emerald-200
                    /* Subtle gradient for the result area */
                    bg-gradient-to-br from-emerald-50 to-emerald-100">
            <h2 class="text-xl font-semibold text-emerald-800 mb-2 text-center">Detection Result:</h2>
            <div id="detectionContent">
                <p class="text-lg text-emerald-700 text-center">Please upload an image to detect disease.</p>
            </div>
        </div>
    </div>

    <script>
        const imageUpload = document.getElementById('imageUpload');
        const leafCanvas = document.getElementById('leafCanvas');
        const ctx = leafCanvas.getContext('2d');
        const detectButton = document.getElementById('detectButton');
        const detectionContent = document.getElementById('detectionContent');

        let uploadedImage = null;

        // Disease data with descriptions and remedies
        const diseaseData = {
            "Healthy": {
                description: "The plant shows no signs of disease. Its leaves are vibrant and free from spots, discoloration, or deformities.",
                remedies: "Continue with good plant care practices: adequate watering, proper sunlight, and balanced fertilization."
            },
            "Early Blight": {
                description: "Characterized by dark, concentric spots on older leaves, often with a yellow halo. It's caused by a fungus and can lead to defoliation.",
                remedies: "Remove infected leaves, ensure good air circulation, avoid overhead watering, and apply fungicides as needed. Rotate crops annually."
            },
            "Late Blight": {
                description: "Appears as irregular, water-soaked spots that rapidly turn brown or black, often with a fuzzy white mold on the underside of leaves in humid conditions. Highly destructive.",
                remedies: "Remove and destroy infected plants immediately. Apply preventative fungicides. Ensure good drainage and avoid planting in overly dense areas."
            },
            "Leaf Spot": {
                description: "Small, circular or irregular spots with distinct borders, varying in color (brown, black, tan) depending on the pathogen. Can be fungal or bacterial.",
                remedies: "Prune affected leaves, improve air circulation, water at the base of the plant, and use appropriate fungicides or bactericides."
            },
            "Powdery Mildew": {
                description: "A white, powdery growth on the surface of leaves, stems, and flowers. It thrives in humid conditions but doesn't require standing water.",
                remedies: "Increase air circulation, prune heavily infected parts, and apply fungicides specifically for powdery mildew. Neem oil can also be effective."
            },
            "Rust": {
                description: "Characterized by small, rusty-orange, brown, or yellow pustules (blisters) on the underside of leaves. These release spores that spread the disease.",
                remedies: "Remove infected leaves, ensure good air circulation, avoid overhead watering, and apply fungicides. Choose rust-resistant varieties if available."
            },
            "Scab": {
                description: "Causes raised, corky, or sunken lesions on leaves, fruits, and stems. Often appears as olive-green spots that turn brown or black.",
                remedies: "Prune infected branches, remove fallen leaves, and apply fungicides during susceptible periods. Sanitation is key to preventing spread."
            },
            "Bacterial Blight": {
                description: "Causes water-soaked lesions that turn brown or black, often with a yellow halo. Can lead to wilting and dieback.",
                remedies: "Remove and destroy infected plant parts. Avoid overhead watering. Use copper-based bactericides. Sanitize tools between plants."
            },
            "Mosaic Virus": {
                description: "Causes mottled, distorted, or stunted growth with patterns of light and dark green or yellow on leaves. Spread by insects (like aphids) or contaminated tools.",
                remedies: "There is no cure for viral diseases. Remove and destroy infected plants to prevent spread. Control insect vectors and sanitize tools."
            }
        };

        const possibleDiseaseNames = Object.keys(diseaseData);

        // Function to resize canvas and draw image
        function drawImageOnCanvas(image) {
            const aspectRatio = image.width / image.height;
            let newWidth = leafCanvas.offsetWidth;
            let newHeight = newWidth / aspectRatio;

            // If the calculated height exceeds the max height, adjust
            const maxHeight = 384; // Corresponds to h-96 in Tailwind (96 * 4 = 384px)
            if (newHeight > maxHeight) {
                newHeight = maxHeight;
                newWidth = newHeight * aspectRatio;
            }

            leafCanvas.width = newWidth;
            leafCanvas.height = newHeight;

            // Clear canvas before drawing new image
            ctx.clearRect(0, 0, leafCanvas.width, leafCanvas.height);
            ctx.drawImage(image, 0, 0, leafCanvas.width, leafCanvas.height);

            // Enable the detect button once an image is loaded
            detectButton.disabled = false;
        }

        // Handle image file selection
        imageUpload.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImage = new Image();
                    uploadedImage.onload = () => {
                        drawImageOnCanvas(uploadedImage);
                        detectionContent.innerHTML = `<p class="text-lg text-emerald-700 text-center">Image loaded. Click "Detect Disease" to analyze.</p>`;
                    };
                    uploadedImage.src = e.target.result;
                };
                reader.readAsDataURL(file);
            } else {
                // Clear canvas if no file is selected
                ctx.clearRect(0, 0, leafCanvas.width, leafCanvas.height);
                leafCanvas.width = leafCanvas.offsetWidth; // Reset width
                leafCanvas.height = 384; // Reset height to default
                detectButton.disabled = true;
                detectionContent.innerHTML = `<p class="text-lg text-emerald-700 text-center">Please upload an image to detect disease.</p>`;
                uploadedImage = null;
            }
        });

        // Handle window resize to make canvas responsive
        window.addEventListener('resize', () => {
            if (uploadedImage) {
                drawImageOnCanvas(uploadedImage);
            } else {
                // If no image, just adjust canvas dimensions
                leafCanvas.width = leafCanvas.offsetWidth;
                leafCanvas.height = 384; // Keep the default height
            }
        });

        // Initial canvas size setup
        window.onload = () => {
            leafCanvas.width = leafCanvas.offsetWidth;
            leafCanvas.height = 384; // Set a default height
        };

        // Handle detection button click (placeholder for actual model inference)
        detectButton.addEventListener('click', () => {
            if (uploadedImage) {
                detectionContent.innerHTML = `<p class="text-lg text-emerald-700 text-center">Analyzing image... (This is a placeholder for actual detection)</p>`;
                detectButton.disabled = true; // Disable button during "detection"

                // Simulate a delay for detection
                setTimeout(() => {
                    const randomDiseaseName = possibleDiseaseNames[Math.floor(Math.random() * possibleDiseaseNames.length)];
                    const diseaseInfo = diseaseData[randomDiseaseName];

                    detectionContent.innerHTML = `
                        <p class="text-xl font-bold text-emerald-800 mb-2 text-center">Detected: ${randomDiseaseName}</p>
                        <h3 class="text-lg font-semibold text-emerald-700 mt-4">Description:</h3>
                        <p class="text-base text-gray-700 mb-4">${diseaseInfo.description}</p>
                        <h3 class="text-lg font-semibold text-emerald-700">Remedies:</h3>
                        <p class="text-base text-gray-700">${diseaseInfo.remedies}</p>
                    `;
                    detectButton.disabled = false; // Re-enable button
                }, 2000); // Simulate 2-second detection time
            } else {
                detectionContent.innerHTML = `<p class="text-lg text-emerald-700 text-center">Please upload an image first!</p>`;
            }
        });
    </script>
</body>
</html>
